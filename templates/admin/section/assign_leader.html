{% extends "admin/admin.html" %}

{% block content %}

<div class="fade-in">

    <!-- ================= HEADER ================= -->

    <h2 class="fw-bold mb-3">
        Assign Team Leader
    </h2>

    <p class="text-muted mb-4">
        Assign leaders to projects and teams
    </p>


    <!-- ================= ASSIGN FORM ================= -->

    <div class="table-card mb-4">

        <h5 class="fw-bold mb-4">
            Assign Project Leader
        </h5>


        <form method="POST" action="{{ url_for('admin.assign_leader') }}">


            <div class="row g-3">


                <!-- Project -->
                <div class="col-md-6">

                    <label class="form-label">
                        Select Project *
                    </label>

                    <select name="project_id" class="form-select" required>

                        <option value="">
                            Choose Project
                        </option>

                        {% for project in projects %}

                        <option value="{{ project.project_id }}">
                            {{ project.project_name }}
                        </option>

                        {% endfor %}

                    </select>

                </div>


                <!-- Leader -->
                <div class="col-md-6">

                    <label class="form-label">
                        Select Leader *
                    </label>

                    <select name="leader_id" class="form-select" required>

                        <option value="">
                            Choose Leader
                        </option>

                        {% for leader in leaders %}

                        <option value="{{ leader.user_id }}">
                            {{ leader.name }}
                            ({{ leader.designation }})
                        </option>

                        {% endfor %}

                    </select>

                </div>


                <!-- Date -->
                <div class="col-12">

                    <label class="form-label">
                        Assignment Date *
                    </label>

                    <input type="date" name="assigned_date" class="form-control" required>

                </div>


                <!-- Notes -->
                <div class="col-12">

                    <label class="form-label">
                        Notes (Optional)
                    </label>

                    <textarea name="notes" class="form-control" rows="3" placeholder="Add notes..."></textarea>

                </div>


                <!-- Submit -->
                <div class="col-12">

                    <button type="submit" class="btn btn-primary px-4">

                        Assign Leader

                    </button>

                </div>

            </div>

        </form>

    </div>



    <!-- ================= ASSIGNMENTS TABLE ================= -->

    <div class="table-card mt-4">

        <h5 class="fw-bold mb-4">
            Current Assignments
        </h5>


        <table class="custom-table">

            <thead>

                <tr>
                    <th>Project</th>
                    <th>Leader</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>

            </thead>


            <tbody>


                {% for a in assignments %}

                <tr>

                    <!-- Project -->
                    <td>
                        {{ a.project_name }}
                    </td>


                    <!-- Leader -->
                    <td>

                        <div class="d-flex align-items-center">

                            <div class="user-avatar me-2">
                                {{ a.leader_name[0] }}
                            </div>

                            {{ a.leader_name }}

                        </div>

                    </td>


                    <!-- Date -->
                    <td>
                        {{ a.assigned_date }}
                    </td>


                    <!-- Status -->
                    <td>

                        {% if a.status == "active" %}

                        <span class="status-badge status-active">
                            Active
                        </span>

                        {% else %}

                        <span class="status-badge status-inactive">
                            Inactive
                        </span>

                        {% endif %}

                    </td>


                    <!-- Remove -->
                    <td>

                        <form method="POST" action="{{ url_for('admin.remove_assignment', id=a.id) }}"
                            onsubmit="return confirm('Remove this assignment?')">

                            <button type="submit" class="btn btn-sm btn-outline-danger">

                                Remove

                            </button>

                        </form>

                    </td>

                </tr>

                {% else %}

                <tr>

                    <td colspan="5" class="text-center text-muted">

                        No assignments yet

                    </td>

                </tr>

                {% endfor %}


            </tbody>

        </table>

    </div>

</div>

{% endblock %}